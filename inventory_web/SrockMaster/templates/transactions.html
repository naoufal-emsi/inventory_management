{% extends 'base.html' %}

{% block title %}Transactions - Inventory Management{% endblock %}

{% block content %}
<h1>Transactions</h1>

<div class="transaction-forms">
    <div class="form-section">
        <h2>Record Sale</h2>
        <form method="POST" action="{% url 'record_sale' %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="sale_product">Product:</label>
                <select id="sale_product" name="product" class="form-control" required>
                    {% for product in products %}
                    <option value="{{ product.id }}">{{ product.name }} (Stock: {{ product.quantity }})</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="sale_quantity">Quantity:</label>
                <input type="number" id="sale_quantity" name="quantity" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-success">Record Sale</button>
        </form>
    </div>

    <div class="form-section">
        <h2>Record Purchase</h2>
        <form method="POST" action="{% url 'record_purchase' %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="purchase_product">Product:</label>
                <select id="purchase_product" name="product" class="form-control" required>
                    {% for product in products %}
                    <option value="{{ product.id }}">{{ product.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="purchase_quantity">Quantity:</label>
                <input type="number" id="purchase_quantity" name="quantity" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="purchase_price">Price per unit:</label>
                <input type="number" id="purchase_price" name="price" step="0.01" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-success">Record Purchase</button>
        </form>
    </div>
</div>

<h2>Transaction History</h2>
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Product</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody>
        {% for transaction in transactions %}
        <tr>
            <td>{{ transaction.date }}</td>
            <td>{{ transaction.get_type_display }}</td>
            <td>{{ transaction.produit.name }}</td>
            <td>{{ transaction.quantity }}</td>
            <td>${{ transaction.price }}</td>
            <td>${{ transaction.price|multiply:transaction.quantity }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}