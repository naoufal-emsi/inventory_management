{% extends 'base.html' %}
{% block title %}Customers - StockPro{% endblock %}
{% block content %}
<h1 style="text-align:center;margin-bottom:2rem;">Customers</h1>
<div class="dashboard-stats" style="margin-bottom:2rem;">
    <div class="stat-card">
        <h3>Total Customers</h3>
        <p>{{ customers|length }}</p>
    </div>
    <div class="stat-card">
        <h3>Total Purchases</h3>
        <p>{{ purchases|length }}</p>
    </div>
</div>
<div class="form-section" style="margin-bottom:2rem;">
    <h2 style="margin-bottom:1rem;">Add Customer & Purchase</h2>
    <form method="POST" style="max-width:500px;margin:auto;">
        {% csrf_token %}
        <div class="form-group">
            {{ customer_form.name.label_tag }}
            {{ customer_form.name }}
        </div>
        <div class="form-group">
            {{ customer_form.email.label_tag }}
            {{ customer_form.email }}
        </div>
        <div class="form-group">
            {{ customer_form.phone.label_tag }}
            {{ customer_form.phone }}
        </div>
        <div class="form-group">
            {{ customer_form.address.label_tag }}
            {{ customer_form.address }}
        </div>
        <div class="form-group">
            {{ purchase_form.product.label_tag }}
            {{ purchase_form.product }}
        </div>
        <div class="form-group">
            {{ purchase_form.quantity.label_tag }}
            {{ purchase_form.quantity }}
        </div>
        <div class="form-group">
            <small style="color:#6366f1;">Price will be calculated automatically.</small>
        </div>
        <button type="submit" class="btn btn-success" style="width:100%;">Add Customer & Purchase</button>
    </form>
</div>

<div class="dashboard-stats" style="margin-bottom:2rem;">
    <div class="form-section" style="width:100%;">
        <h2>Customer List</h2>
        <table class="table">
            <thead>
                <tr><th>Name</th><th>Email</th><th>Phone</th><th>Address</th></tr>
            </thead>
            <tbody>
                {% for customer in customers %}
                <tr>
                    <td>{{ customer.name }}</td>
                    <td>{{ customer.email }}</td>
                    <td>{{ customer.phone }}</td>
                    <td>{{ customer.address }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="4" style="text-align:center;">No customers yet.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="form-section" style="margin-bottom:2rem;">
    <h2>Purchase History</h2>
    <table class="table">
        <thead>
            <tr><th>Date</th><th>Customer</th><th>Product</th><th>Quantity</th><th>Price</th><th>Added By</th></tr>
        </thead>
        <tbody>
            {% for purchase in purchases %}
            <tr>
                <td>{{ purchase.date|date:"Y-m-d H:i" }}</td>
                <td>{{ purchase.customer.name }}</td>
                <td>{{ purchase.product.name }}</td>
                <td>{{ purchase.quantity }}</td>
                <td><span style="color:#22c55e;">${{ purchase.price }}</span></td>
                <td>{{ purchase.added_by.username }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="6" style="text-align:center;">No purchases yet.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
